{"openapi":"3.1.0","info":{"title":"Book Platform API","description":"API для книжного магазина: каталог, корзина, заказы, AI-ассистент","contact":{"name":"BSUIR Student","email":"student@bsuir.by"},"version":"1.0.0"},"servers":[{"url":"http://localhost:8081","description":"Generated server url"}],"security":[{"JWT":[]}],"tags":[{"name":"Catalog","description":"Поиск книг и управление ассортиментом"},{"name":"Reviews","description":"Управление отзывами и рейтингами"},{"name":"Orders","description":"Управление заказами"},{"name":"User Profile","description":"Управление профилем пользователя"},{"name":"Authentication","description":"Регистрация и вход пользователей"},{"name":"Analytics","description":"Статистика и аналитика продаж"},{"name":"AI Assistant","description":"Чат с умным консультантом"}],"paths":{"/api/users/me/addresses":{"post":{"tags":["User Profile"],"summary":"Добавить адрес","description":"Добавляет новый адрес доставки","operationId":"addAddress","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddAddressRequest"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/api/reviews":{"post":{"tags":["Reviews"],"summary":"Оставить отзыв","description":"Добавляет отзыв к книге от имени текущего пользователя. Требуется авторизация.","operationId":"addReview","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateReviewRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string","format":"uuid"}}}}}}},"/api/orders":{"get":{"tags":["Orders"],"summary":"Получить все заказы (Менеджер)","description":"Доступно только пользователям с ролью MANAGER","operationId":"getAllOrders","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Order"}}}}}}},"post":{"tags":["Orders"],"summary":"Оформить заказ","description":"Создает заказ на основе списка книг и данных о доставке","operationId":"createOrder","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOrderRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string","format":"uuid"}}}}}}},"/api/chat":{"post":{"tags":["AI Assistant"],"summary":"Отправить сообщение","description":"Обработка запроса пользователя через LLM (OpenAI)","operationId":"chat","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ChatResponse"}}}}}}},"/api/catalog/import":{"post":{"tags":["Catalog"],"summary":"Импорт книги (Менеджер)","description":"Загрузка книги из Google Books API по ISBN","operationId":"importBookFromExternalApi","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ImportBookRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/catalog/books":{"post":{"tags":["Catalog"],"summary":"Создание книги","description":"Создает новую книгу по введенным данным","operationId":"createBook","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateBookRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string","format":"uuid"}}}}}}},"/api/auth/register":{"post":{"tags":["Authentication"],"summary":"Регистрация","description":"Регистрирует нового клиента. Пароль шифруется. Email проверяется на уникальность.","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthenticationResponse"}}}}},"security":[]}},"/api/auth/authenticate":{"post":{"tags":["Authentication"],"summary":"Вход в систему","description":"Проверяет логин/пароль и выдает JWT токен.","operationId":"authenticate","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthenticationRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthenticationResponse"}}}}},"security":[]}},"/api/users/me":{"get":{"tags":["User Profile"],"summary":"Получить мой профиль","operationId":"getMyProfile","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserProfileResponse"}}}}}},"patch":{"tags":["User Profile"],"summary":"Обновить профиль","description":"Изменить имя, фамилию или телефон","operationId":"updateProfile","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProfileRequest"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/api/orders/{id}/status":{"patch":{"tags":["Orders"],"summary":"Обновить статус заказа","description":"Обновляет статус выбранного заказа на предоставленный","operationId":"updateStatus","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid"}},{"name":"status","in":"query","required":true,"schema":{"type":"string","enum":["NEW","PROCESSING","SHIPPED","DELIVERED","CANCELLED"]}}],"responses":{"200":{"description":"OK"}}}},"/api/reviews/book/{bookId}":{"get":{"tags":["Reviews"],"summary":"Получить отзывы книги","description":"Возвращает список всех отзывов для указанной книги, отсортированных по дате.","operationId":"getBookReviews","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Review"}}}}}}}},"/api/orders/my":{"get":{"tags":["Orders"],"summary":"Получить мои заказы","description":"Возвращает историю заказов текущего пользователя","operationId":"getMyOrders","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Order"}}}}}}}},"/api/catalog/search":{"get":{"tags":["Catalog"],"summary":"Поиск книг","description":"Полнотекстовый поиск через Elasticsearch (Название, Автор, Описание)","operationId":"search","parameters":[{"name":"q","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookDocument"}}}}}}}},"/api/analytics":{"get":{"tags":["Analytics"],"summary":"Получить дашборд","description":"Возвращает сводные данные по продажам, топ книг и графики. Доступно только для роли MANAGER.","operationId":"getDashboard","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AnalyticsResponse"}}}}}}},"/api/reviews/{id}":{"delete":{"tags":["Reviews"],"summary":"Удалить отзыв (Модерация)","description":"Удаляет отзыв по ID. Доступно только для роли MANAGER.","operationId":"deleteReview","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"OK"}}}}},"components":{"schemas":{"AddAddressRequest":{"type":"object","properties":{"addressName":{"type":"string"},"addressText":{"type":"string"},"isDefault":{"type":"boolean"}}},"CreateReviewRequest":{"type":"object","properties":{"bookId":{"type":"string","format":"uuid"},"rating":{"type":"integer","format":"int32"},"text":{"type":"string"}}},"CreateOrderRequest":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/ItemDto"}},"deliveryDetails":{"$ref":"#/components/schemas/DeliveryDto"}}},"DeliveryDto":{"type":"object","properties":{"customerName":{"type":"string"},"phone":{"type":"string"},"address":{"type":"string"},"timeSlot":{"type":"string"}}},"ItemDto":{"type":"object","properties":{"bookId":{"type":"string","format":"uuid"},"quantity":{"type":"integer","format":"int32"}}},"ChatRequest":{"type":"object","properties":{"message":{"type":"string"}}},"ChatResponse":{"type":"object","properties":{"response":{"type":"string"}}},"ImportBookRequest":{"type":"object","properties":{"isbn":{"type":"string"},"price":{"type":"number"},"stock":{"type":"integer","format":"int32"}}},"CreateBookRequest":{"type":"object","properties":{"title":{"type":"string"},"description":{"type":"string"},"isbn":{"type":"string"},"price":{"type":"number"},"stock":{"type":"integer","format":"int32"},"authorIds":{"type":"array","items":{"type":"string","format":"uuid"}},"genreIds":{"type":"array","items":{"type":"string","format":"uuid"}}}},"RegisterRequest":{"type":"object","properties":{"username":{"type":"string"},"email":{"type":"string"},"password":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"phone":{"type":"string"}}},"AuthenticationResponse":{"type":"object","properties":{"token":{"type":"string"}}},"AuthenticationRequest":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"}}},"UpdateProfileRequest":{"type":"object","properties":{"firstName":{"type":"string"},"lastName":{"type":"string"},"phone":{"type":"string"}}},"AddressDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"addressName":{"type":"string"},"addressText":{"type":"string"},"isDefault":{"type":"boolean"}}},"UserProfileResponse":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"username":{"type":"string"},"email":{"type":"string"},"contactPhone":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"role":{"type":"string","enum":["CLIENT","MANAGER"]},"addresses":{"type":"array","items":{"$ref":"#/components/schemas/AddressDto"}}}},"Author":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"name":{"type":"string"},"biography":{"type":"string"}}},"Book":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"title":{"type":"string"},"isbn":{"type":"string"},"description":{"type":"string"},"stockQuantity":{"type":"integer","format":"int32"},"cost":{"type":"number"},"authors":{"type":"array","items":{"$ref":"#/components/schemas/Author"},"uniqueItems":true},"genres":{"type":"array","items":{"$ref":"#/components/schemas/Genre"},"uniqueItems":true},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"Genre":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"name":{"type":"string"}}},"GrantedAuthority":{"type":"object","properties":{"authority":{"type":"string"}}},"Review":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"user":{"$ref":"#/components/schemas/User"},"book":{"$ref":"#/components/schemas/Book"},"rating":{"type":"integer","format":"int32"},"text":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"User":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"username":{"type":"string"},"password":{"type":"string"},"email":{"type":"string"},"contactPhone":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"role":{"type":"string","enum":["CLIENT","MANAGER"]},"addresses":{"type":"array","items":{"$ref":"#/components/schemas/UserAddress"}},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"enabled":{"type":"boolean"},"authorities":{"type":"array","items":{"$ref":"#/components/schemas/GrantedAuthority"}},"accountNonLocked":{"type":"boolean"},"accountNonExpired":{"type":"boolean"},"credentialsNonExpired":{"type":"boolean"}}},"UserAddress":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"user":{},"addressName":{"type":"string"},"addressText":{"type":"string"},"isDefault":{"type":"boolean"}}},"DeliveryDetails":{"type":"object","properties":{"orderId":{"type":"string","format":"uuid"},"customerName":{"type":"string"},"contactPhone":{"type":"string"},"addressText":{"type":"string"},"deliveryTimeSlot":{"type":"string"},"deliveryDate":{"type":"string","format":"date-time"}}},"Order":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"orderNumber":{"type":"string"},"user":{"$ref":"#/components/schemas/User"},"status":{"type":"string","enum":["NEW","PROCESSING","SHIPPED","DELIVERED","CANCELLED"]},"totalCost":{"type":"number"},"orderItems":{"type":"array","items":{"$ref":"#/components/schemas/OrderItem"}},"deliveryDetails":{"$ref":"#/components/schemas/DeliveryDetails"},"orderDate":{"type":"string","format":"date-time"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"OrderItem":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"book":{"$ref":"#/components/schemas/Book"},"bookTitle":{"type":"string"},"isbn":{"type":"string"},"quantity":{"type":"integer","format":"int32"},"pricePerItem":{"type":"number"},"totalPrice":{"type":"number"}}},"BookDocument":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"isbn":{"type":"string"},"price":{"type":"number"},"authors":{"type":"array","items":{"type":"string"}},"genres":{"type":"array","items":{"type":"string"}}}},"AnalyticsResponse":{"type":"object","properties":{"summary":{"$ref":"#/components/schemas/Summary"},"salesOverTime":{"type":"array","items":{"$ref":"#/components/schemas/DatePoint"}},"salesByCategory":{"type":"array","items":{"$ref":"#/components/schemas/CategoryPoint"}},"topSellingBooks":{"type":"array","items":{"$ref":"#/components/schemas/BookPoint"}}}},"BookPoint":{"type":"object","properties":{"title":{"type":"string"},"soldCount":{"type":"integer","format":"int64"}}},"CategoryPoint":{"type":"object","properties":{"category":{"type":"string"},"count":{"type":"integer","format":"int64"}}},"DatePoint":{"type":"object","properties":{"date":{"type":"string"},"value":{"type":"number"}}},"Summary":{"type":"object","properties":{"totalOrders":{"type":"integer","format":"int64"},"totalRevenue":{"type":"number"},"totalBooksSold":{"type":"integer","format":"int64"},"averageCheck":{"type":"number","format":"double"}}}},"securitySchemes":{"JWT":{"type":"http","description":"Вставьте сюда ваш токен","scheme":"bearer","bearerFormat":"JWT"}}}}